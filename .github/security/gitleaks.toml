title = "Clisonix Cloud Gitleaks Config"
description = "Enhanced secret patterns for supply chain security"
version = 1.0

[allowlist]
description = "Allowlist for test/stub credentials"
paths = ["(?i)(test|spec|stub)"]

[rules.private_key]
description = "Private key file"
regex = '''-----BEGIN RSA PRIVATE KEY-----'''
tags = ["key", "asymmetric"]
entropy = 3.5
secret = true

[rules.github_token]
description = "GitHub Personal Access Token"
regex = '''ghp_[0-9a-zA-Z]{36}'''
tags = ["github", "token"]
entropy = 3.2
secret = true

[rules.github_oauth]
description = "GitHub OAuth Token"
regex = '''gho_[0-9a-zA-Z]{36}'''
tags = ["github", "oauth"]
entropy = 3.2
secret = true

[rules.github_app_token]
description = "GitHub App Token"
regex = '''ghu_[0-9a-zA-Z]{36}'''
tags = ["github", "app"]
entropy = 3.2
secret = true

[rules.gitlab_token]
description = "GitLab Personal Access Token"
regex = '''glpat-[0-9a-zA-Z_\-]{20}'''
tags = ["gitlab", "token"]
entropy = 3.1
secret = true

[rules.aws_key]
description = "AWS Access Key"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws", "key"]
entropy = 3.5
secret = true

[rules.aws_secret]
description = "AWS Secret Access Key"
regex = '''aws_secret_access_key\s*=\s*[A-Za-z0-9/+=]{40}'''
tags = ["aws", "secret"]
entropy = 3.5
secret = true

[rules.jwt_secret]
description = "JWT Secret"
regex = '''jwt_secret\s*[:=]\s*['"]?[A-Za-z0-9_\-\.]{32,}['"]?'''
tags = ["jwt", "secret"]
entropy = 3.3
secret = true

[rules.postgres_password]
description = "PostgreSQL Password"
regex = '''postgres.*password\s*[:=]\s*['"]([A-Za-z0-9!@#$%^&*]{8,})['"]'''
tags = ["postgres", "password"]
entropy = 3.2
secret = true

[rules.api_key_generic]
description = "Generic API Key"
regex = '''api[_-]?key\s*[:=]\s*['"]?[A-Za-z0-9_\-]{20,}['"]?'''
tags = ["api", "key"]
entropy = 3.1
secret = true

[rules.slack_token]
description = "Slack Bot Token"
regex = '''xoxb-[0-9]{10,13}-[0-9]{10,13}-[A-Za-z0-9_-]{24,34}'''
tags = ["slack", "token"]
entropy = 3.2
secret = true

[rules.slack_webhook]
description = "Slack Webhook"
regex = '''https://hooks\.slack\.com/services/T[A-Z0-9]+/B[A-Z0-9]+/[A-Za-z0-9_\-]{24}'''
tags = ["slack", "webhook"]
entropy = 3.1
secret = true

[rules.stripe_key]
description = "Stripe API Key"
regex = '''sk_live_[0-9a-zA-Z]{24,}'''
tags = ["stripe", "key"]
entropy = 3.4
secret = true

[rules.database_url]
description = "Database Connection String"
regex = '''(postgres|mysql|mongodb)([+a-z]*)?://[^:]+:[^@]+@[^/]+/'''
tags = ["database", "connection"]
entropy = 3.2
secret = true

[rules.env_secrets]
description = "Secrets in .env files"
regex = '''(PASSWORD|SECRET|TOKEN|KEY|CREDENTIAL|APIKEY)\s*=\s*[A-Za-z0-9!@#$%^&*_\-\.]{8,}'''
tags = ["env", "secret"]
entropy = 3.0
secret = true
